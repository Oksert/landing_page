<html><head></head><body><p>Кроме штатной выгрузки отчетов в Excel можно настроить выгрузку отчета в Excel-файл заданного шаблона, где можно настроить заголовки, шрифты, выравнивание, перенос слов и другие настройки форматирования.</p><p style="margin-bottom:7.5pt;"><span style="font-family:Helvetica, sans-serif;">Для того, чтобы сформировать печатную форму в формате xlsx (формат Word ) нужно выполнить следующие действия:</span></p><ol><li><span style="font-size:10.5pt;font-family:Helvetica, sans-serif;">Создать шаблон выгрузки в формате .</span><span lang="EN-US" style="font-size:10.5pt;font-family:Helvetica, sans-serif;">xlsx</span><span style="font-size:10.5pt;font-family:Helvetica, sans-serif;"> и вставить его на сервер.</span></li><li><span style="font-size:10.5pt;font-family:Helvetica, sans-serif;">Создать правило по генерации выгрузки.</span></li><li><span style="font-size:10.5pt;font-family:Helvetica, sans-serif;">Привязать это правило к кнопке, по нажатию на которую будет осуществляться выгрузка.</span></li></ol><p><span style="font-size:10.5pt;font-family:Helvetica, sans-serif;">Ниже подробно описан каждый из пунктов.</span></p><h3 style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;color:#333333;"><span style="font-weight:700;">Создание шаблона</span></h3><p style="margin-bottom:7.5pt;">Для создания шаблона печатной формы нужно:</p><h3></h3><p>1. На сервере приложений выполнить код</p><div style="background:#f8f8f8;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin:0;line-height:125%;">ExcelReportEngine ere2 <span style="color:#666666;">=</span> <span style="color:#008000;font-weight:bold;">new</span> ExcelReportEngine<span style="color:#666666;">();</span>
ere2<span style="color:#666666;">.</span><span style="color:#7D9029;">createReportTemplate</span><span style="color:#666666;">(</span>reportId<span style="color:#666666;">);</span>

ere2<span style="color:#666666;">.</span><span style="color:#7D9029;">writeToFile</span><span style="color:#666666;">(</span>directory<span style="color:#666666;">)</span>
</pre></div><p></p><p>где <strong>reportId</strong> - id отчета в формате Integer, </p><p><strong>directory </strong>- директория где будет создан отчет. По умолчанию шаблон будет создан в папке C:/Temp<br><br>2. Шаблон нужно отформатировать (при этом заканчиваться документ должен данными из отчета, т.е. под строкой с названиями столбцов нельзя писать никакой текст, кроме того поля результатов и параметры запроса нельзя использовать в формулах Excel) и положить в стандартную папку с шаблонами (C:/IPData/Templates) с именем, сформированным по следующему правилу:<br><br> report_export_template_"report short name".xlsx.<br><br>3. Необходимо поставить галочку <strong>Показать печатную форму</strong> в определении отчета, после чего у отчета появится кнопка "Печатная форма".<br><br>Если шаги 1-2 были пропущены, то система сама сгенерирует шаблон в памяти сервера (но в папку его не положит).<br><br>4. Если потребуется сгенерировать печатную форму в коде, но нужно вызвать код указав <strong>Краткое наименование</strong> отчета (SHORTNAME):<br><!-- HTML generated using hilite.me --></p><div style="background:#f8f8f8;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin:0;line-height:125%;">Map queryParamsMap<span style="color:#666666;">=</span> <span style="color:#AA22FF;font-weight:bold;">new</span> HashMap<span style="color:#666666;">();</span>
queryParamsMap<span style="color:#666666;">.</span><span style="color:#BB4444;">put</span><span style="color:#666666;">(</span><span style="color:#BB4444;">"BRANCH"</span><span style="color:#666666;">,</span> <span style="color:#666666;">2);</span>
ExportUtils<span style="color:#666666;">.</span><span style="color:#BB4444;">exportReportToExcel</span><span style="color:#666666;">(</span><span style="color:#BB4444;">"32d20196-4f22-4473-8ba0-ead71d460e42"</span><span style="color:#666666;">,</span> queryParamsMap<span style="color:#666666;">,</span> <span style="color:#BB4444;">"C:/TEMP/r_tpl_187.xlsx"</span><span style="color:#666666;">);</span>
</pre></div><p></p><p>Или по номеру отчета:<br><!-- HTML generated using hilite.me --></p><div style="background:#f8f8f8;overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin:0;line-height:125%;">Map queryParamsMap<span style="color:#666666;">=</span> <span style="color:#AA22FF;font-weight:bold;">new</span> HashMap<span style="color:#666666;">();</span>
queryParamsMap<span style="color:#666666;">.</span><span style="color:#BB4444;">put</span><span style="color:#666666;">(</span><span style="color:#BB4444;">"BRANCH"</span><span style="color:#666666;">,</span> <span style="color:#666666;">2);</span>
<span style="color:#008800;font-style:italic;">// queryParamsMap.put("PERIOD_START_PS", "2016-01-01");</span>
ExportUtils<span style="color:#666666;">.</span><span style="color:#BB4444;">exportReportToExcel</span><span style="color:#666666;">(187,</span> queryParamsMap<span style="color:#666666;">,</span> <span style="color:#BB4444;">"C:/TEMP/r_tpl_187.xlsx"</span><span style="color:#666666;">);</span>
</pre></div><p></p><p></p></body></html>