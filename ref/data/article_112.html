<div><p>Для того, чтобы иметь возможность генерировать печатные формы отчетов нужно:</p><p>1. На сервере приложений выполнить код</p><blockquote><p><span style="color:#000000;">ExcelReportEngine ere2 = new ExcelReportEngine();</span><br style="color:#000000;" /><span style="color:#000000;">ere2.createReportTemplate(reportId);</span></p><p><span style="color:#000000;">ere2.writeToFile(directory)</span></p></blockquote></div><p>где&nbsp;<span style="color:#000000;">reportId - id отчета в формате Integer, directory - директория где будет создан отчет</span></p><p>&nbsp;Шаблон будет создан в папке&nbsp;<span style="color:#000000;">C:/Temp</span></p><p>2. Шаблон нужно отформатировать (при этом заканчиваться документ должен данными из отчета, т.е. под строкой с названиями столбцов нельзя писать никакой текст, кроме того поля результатов и параметры запроса нельзя использовать в формулах Excel) и положить<span style="color:#000000;">&nbsp;в стандартную папку с шаблонами (C:/IPData/Templates) с именем, сформированным по следующему правилу:</span></p><p><span style="color:#000000;">&nbsp;report_export_template_"report short name".xlsx.</span></p><p><span style="color:#000000;"></span>3. Нужно поставить галочку "Показать печатную форму" в определении отчета, после чего у отчета появится кнопка "Печатная форма".</p><p><span style="color:#000000;"></span>Если шаги 1-2 были пропущены, то система сама сгенерирует шаблон в памяти сервера (но в папку его не положит).</p><p>4. Если потребуется сгенерировать печатную форму в коде, но нужно вызвать код указав Краткое наименование отчета (SHORTNAME):</p><blockquote><span style="color:#000000;">Map</span><string, object="" style="color:#000000;">&nbsp;queryParamsMap= new HashMap<string, object="">();<br />queryParamsMap.put("BRANCH", 2);<br />//	queryParamsMap.put("PERIOD_START_PS", "2016-01-01");<br />ExportUtils.exportReportToExcel("32d20196-4f22-4473-8ba0-ead71d460e42", queryParamsMap, "C:/TEMP/r_tpl_187.xlsx");<br /></string,></string,></blockquote><p>Или по номеру отчета:</p><blockquote><p><span style="color:#000000;font-size:17.5px;">Map queryParamsMap= new HashMap();</span><br style="color:#000000;font-size:17.5px;" /><span style="color:#000000;font-size:17.5px;">queryParamsMap.put("BRANCH", 2);</span><br style="color:#000000;font-size:17.5px;" /><span style="color:#000000;font-size:17.5px;">// queryParamsMap.put("PERIOD_START_PS", "2016-01-01");</span><br style="color:#000000;font-size:17.5px;" /><span style="color:#000000;font-size:17.5px;">ExportUtils.exportReportToExcel(187, queryParamsMap, "C:/TEMP/r_tpl_187.xlsx");</span></p></blockquote>