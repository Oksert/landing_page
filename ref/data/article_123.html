<h1 align="center" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;color:#333333;text-align:center;"><span lang="RU">Как обновить сервер приложений на Linux</span></h1><h1 align="center" style="font-family:'Helvetica Neue', Helvetica, Arial, sans-serif;color:#333333;text-align:center;"><span lang="RU">с&nbsp;</span>SAAS Linux DEV</h1><p style="margin-left:41pt;text-indent:-18pt;"><span lang="RU" style="color:#010101;">1.<span style="font-variant-numeric:normal;font-size:7pt;font-family:'Times New Roman';">&nbsp;&nbsp;</span></span><span lang="RU" style="color:#010101;">Заходим на WEB Prod (94.142.141.48) через Putty</span></p><p style="margin-left:41pt;text-indent:-18pt;"><span lang="RU" style="color:#010101;">2.<span style="font-variant-numeric:normal;font-size:7pt;font-family:'Times New Roman';">&nbsp;&nbsp;</span></span><span lang="RU" style="color:#010101;">Сделать бекап рабочего&nbsp;</span><span style="color:#010101;">war</span><span style="color:#010101;">&nbsp;<span lang="RU">файла:</span></span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span style="font-size:11pt;font-family:Calibri;color:#010101;">cp /opt/wildfly/standalone/deployments/IdeaPlatform_SAAS.war /usr/IPDumps/Web/IdeaPlatform_SAAS_&lt;YYYYMMDD&gt;.war</span></p><p style="margin-left:41pt;text-indent:-18pt;"><span lang="RU" style="color:#010101;">3.<span style="font-variant-numeric:normal;font-size:7pt;font-family:'Times New Roman';">&nbsp;&nbsp;</span></span><span lang="RU" style="color:#010101;">Остановить Wildfly</span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">systemctl stop wildfly</span></p><p style="margin-left:41pt;text-indent:-18pt;"><span lang="RU" style="color:#010101;">3.<span style="font-variant-numeric:normal;font-size:7pt;font-family:'Times New Roman';">&nbsp;&nbsp;</span></span><span lang="RU" style="color:#010101;">Скопировать свежий билд IdeaPlatform_SAAS.war с Linux DEV (нужно будет ввести пароль для root пользователя DEV сервера)</span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span style="font-size:11pt;font-family:Calibri;color:#010101;">scp&nbsp;ip</span><span lang="RU"><a href="mailto:root@94.142.142.227:/opt/wildfly/standalone/deployments/IdeaPlatform_SAAS.war%20/opt/wildfly/standalone/deployments/IdeaPlatform_SAAS.war"><span lang="EN-US" style="font-size:11pt;font-family:Calibri;color:#010101;">root@94.142.142.227:/opt/wildfly/standalone/deployments/IdeaPlatform_SAAS.war /opt/wildfly/standalone/deployments/IdeaPlatform_SAAS.war</span></a></span></p><p style="margin-left:41pt;text-indent:-18pt;"><span lang="RU">4.<span style="font-variant-numeric:normal;font-size:7pt;font-family:'Times New Roman';">&nbsp;&nbsp;</span></span><span lang="RU" style="color:#010101;">Выполнить обновление статических файлов. Из папки&nbsp;/opt/IPData/</span>IdeaPlatform_SAAS/<span lang="RU" style="color:#010101;">trunk выполнить команду:</span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">svn update</span></p><p style="margin-left:41pt;text-indent:-18pt;"><span lang="RU" style="color:#010101;">4.<span style="font-variant-numeric:normal;font-size:7pt;font-family:'Times New Roman';">&nbsp;&nbsp;</span></span><span lang="RU" style="color:#010101;">Запустить Wildfly</span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">systemctl start wildfly</span></p><p style="margin-left:41pt;text-indent:-18pt;"><span lang="RU" style="color:#010101;">5.<span style="font-variant-numeric:normal;font-size:7pt;font-family:'Times New Roman';">&nbsp;&nbsp;</span></span><span lang="RU" style="color:#010101;">Проверить, что система запустилась</span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span style="font-size:11pt;font-family:Calibri;color:#010101;">tail -f /var/log/wildfly/console.log</span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;"><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">или</span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span style="font-size:11pt;font-family:Calibri;color:#010101;">less /var/log/wildfly/console.log</span></p><p></p><p><span style="font-weight:700;"><span lang="RU">Если что-то идет не так, то восстановиться можно из бекапа:</span></span></p><p style="margin:0cm 0cm 7.95pt 36.85pt;background:rgb(217, 217, 217);"><span style="font-size:11pt;font-family:Calibri;color:#010101;">cp /usr/IPDumps/Web/IdeaPlatform_SAAS_&lt;YYYYMMDD&gt;.war /opt/wildfly/standalone/deployments/IdeaPlatform_SAAS.war&nbsp;</span></p><p><span lang="RU">при копировании нужно подтвердить переопределение файла&nbsp;</span><span style="color:#010101;">IdeaPlatform</span><span lang="RU" style="color:#010101;">_</span><span style="color:#010101;">SAAS</span><span lang="RU" style="color:#010101;">.</span><span style="color:#010101;">war</span><span lang="RU" style="color:#010101;">&nbsp;(написать слово&nbsp;</span><span style="color:#010101;">yes</span><span lang="RU" style="color:#010101;">)</span></p><p><span style="font-weight:700;"><span lang="RU" style="color:#010101;">Как сделать дамп базы МГЖД:</span></span></p><p><span lang="RU" style="color:#010101;">Дамп базы МГЖД прод можно сделать путем выполнения&nbsp;</span><span style="color:#010101;">sh</span><span style="color:#010101;">&nbsp;<span lang="RU">файла на сервере БД (</span></span><span lang="RU" style="color:#010101;">94.142.141.196</span><span lang="RU" style="color:#010101;">):</span></p><p style="margin:0cm 0cm 7.95pt;background:rgb(217, 217, 217);"><span style="font-size:11pt;font-family:Calibri;color:#010101;">sh</span><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">&nbsp;/</span><span style="font-size:11pt;font-family:Calibri;color:#010101;">usr</span><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">/</span><span style="font-size:11pt;font-family:Calibri;color:#010101;">IPDump</span><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">/</span><span style="font-size:11pt;font-family:Calibri;color:#010101;">autoDump</span><span lang="RU" style="font-size:11pt;font-family:Calibri;color:#010101;">.</span><span style="font-size:11pt;font-family:Calibri;color:#010101;">sh</span></p><p><span lang="RU">скрипт делает дамп системы и складывает его в папку /usr/IPDump/</span>Dumps</p><p><span lang="RU">после чего архивирует его и выкладыват в папку&nbsp;</span>Yandex<span lang="RU">.</span>Disk<span lang="RU">&nbsp;/</span>usr<span lang="RU">/</span>Yandex<span lang="RU">.</span>Disk</p><p></p><p><span style="font-weight:700;">Как запустить Postgres:</span></p><blockquote>systemctl start postgres-9.4</blockquote><p><span style="font-weight:700;">Как открыть порт:</span></p><blockquote>systemctl start&nbsp;firewalld</blockquote><blockquote><p>firewall-cmd --zone=public --add-port=8080/tcp --permanent</p></blockquote><blockquote>firewall-cmd --reload</blockquote><blockquote><p></p><p></p></blockquote><p><span style="font-size:small;"><span style="font-weight:700;">Если сервер приложений стал не доступен и не запускается, то возможно остановился сервис файерволла</span></span></p><p><span style="font-size:small;">Проверяется вот этой командой:</span></p><blockquote><p>systemctl status firewalld</p></blockquote><p>Нужно его поднять:</p><blockquote>systemctl start firewalld</blockquote><div></div>