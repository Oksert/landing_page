<span style="font-size:large;"><strong>Введение</strong></span>.<br />Для мобильной разработки у нас используется фреймворк NativeScript http://docs.nativescript.org, Angular 4 и язык TypeScript.<br />Перед началом рекомендуется ознакомится отдельно с TypeScript пройти тестовый курс тут http://docs.nativescript.org/angular/tutorial/ng-chapter-0 Там рассказывается про установку и настройку. В качестве эмулятора Android можно использовать стандартный, как освоишься со стандартным можно попробовать Genymotion - он быстрее работает.<br /><br /><strong>Репозиторий с мобильным приложением</strong><br />https://bitbucket.org/victor_follet/ip-mobile<br />Основные приложение ip-mobile\runidea, исходники ip-mobile\runidea\app<br />ip-mobile\README.txt - список скриптов, хотфикс бага в NativeScript на iOS, &nbsp;- конфиг компилятора TypeScript<br />Скрипты tns запускаются из папки ip-mobile\runidea<br />Разберем её содержимое<br />&nbsp; &nbsp; ip-mobile\runidea\app - исходники приложения. Структура близка к той, что в демо приложении, с него структура и бралась.<br />&nbsp; &nbsp; ip-mobile\runidea\hooks - генерируется tns, скрипты сборки приложения<br />&nbsp; &nbsp; ip-mobile\runidea\node_modules - библиотеки, как внутренние так и внешние<br />&nbsp; &nbsp; ip-mobile\runidea\platforms - собранные файлы, если фикс этого https://github.com/NativeScript/NativeScript/pull/3587/commits/4b98cf72ac2ac3cf6c25fab5a474e0c4397269de бага, не починят в следующем релизе, то исправлять его нужно в этой папке &nbsp; &nbsp;<br />&nbsp; &nbsp; iOS fix<br />&nbsp; &nbsp; https://github.com/NativeScript/NativeScript/pull/3587/commits/4b98cf72ac2ac3cf6c25fab5a474e0c4397269de<br />&nbsp; &nbsp; &lt; tabBar.items.count &gt; 0&nbsp;<br />&nbsp; &nbsp; =&gt;&nbsp;<br />&nbsp; &nbsp; &lt; tabBar.items &amp;&amp; tabBar.items.count &gt; 0&nbsp;<br /><br /><strong><span style="font-size:large;">ip-mobile\runidea\app</span></strong><br />&nbsp; &nbsp; <em>Центральные файлы</em><br />&nbsp; &nbsp; &nbsp; &nbsp; main.ts &nbsp;- центральный файл, выполняет внедрение основного модуля (app.module.ts) Angular, включает продакшен режим Angular. Еще там были попытки исправить уже описанный баг с табами (функция applyTabViewHotfix), но из этого ничего не вышло, сейчас hot-fix отключен, а когда баг поправят его следует полностью удалить.<br />&nbsp; &nbsp; &nbsp; &nbsp; app.module.ts - файл обеспечивает сборку всех модулей приложения (как стандартных, так и реализованных в приложении) в один модуль. Связывает центральный компонент (app.component.ts) и его роутинг (app.routing.ts)<br />&nbsp; &nbsp; &nbsp; &nbsp; app.component.ts - центральный компонент содержит код page-router-outlet<br />&nbsp; &nbsp; &nbsp; &nbsp; app.routing.ts - содержит сопоставление трех адресов приложения и трех основных компонентов перечисленных в ip-mobile\runidea\app\pages: LoginPage, ListPage и EntityPage<br />&nbsp; &nbsp; &nbsp; &nbsp; Структура файлов main.ts, app.module.ts, app.component.ts и app.routing.ts - стандартная для большинства Angular2+ приложений.&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; При изменении приложения новые страницы добавляются в app.routing.ts, а новые сервисы и компоненты &nbsp;- в app.component.ts, компонеты страниц добавляются в app.component.ts из app.routing.ts автоматически через выражение ...navigatableComponents<br />&nbsp; &nbsp; <strong>Компонеты для разных страниц</strong><br />&nbsp; &nbsp; &nbsp; &nbsp; <strong>ip-mobile\runidea\app\action-bar</strong> - панель верхнего меню, реализует выход logout и переход к экрану логина<br />&nbsp; &nbsp; &nbsp; &nbsp; <strong>ip-mobile\runidea\app\side-drawer</strong>- панель левого меню, открывается по кнопке гамбургера в верхнем меню, состоит из компонента самого меню ip-mobile\runidea\app\side-drawer\side-drawer-page и компонента кнопки (ip-mobile\runidea\app\side-drawer\borderless-btn.directive.ts), которая используется в качестве строки меню.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ip-mobile\runidea\app\side-drawer\side-drawer-page компонент бокового меню работает на основе RadSideDrawerComponent из библиотеки nativescript-telerik-ui/sidedrawer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; side-drawer-page.component.ts<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; По сравнению с библиотечным примером переопределяется navigateTo, который выполняет переход на другую страницу.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; При этом мы&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; отписываемся от всех предыдущих событий на закрытие меню (это важно, что бы не было попыток двух переходов)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; кидаем меню сигнал на закрытие<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; выяснем новую и URL, сравниваем со старой, и если они не равны, то после окончания закрытия меню выполняем переход&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; side-drawer-page.component.html<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RadSideDrawer принимает 2 аргумента: tkDrawerContent (шаблон левой панели) и tkMainContent (шаблон содержимого экрана). Первый - это просто список кнопок.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Второй - либо индикатор загрузки, если данные не прогрузились, либо - содержимое тега (оно подставляется на место ng-content)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ip-mobile\runidea\app\side-drawer\borderless-btn.directive.ts - кнопка без рамок, реализована отдельно, поскольку требует доработки для API Android, копипаст из интернета<br />&nbsp; &nbsp; &nbsp; &nbsp;<strong> ip-mobile\runidea\app\hot-fixes</strong> - сюда предполагается складывать исправления библиотек, но сейчас ни одно из них не используется<br />&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; <strong>ip-mobile\runidea\app\shared </strong>- разделяемые приложением данный. Типы данных и сервисы их получения и изменения<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\values</em> - описание типов возможных значение полей (boolean, number, Pair, DateTime и т.д.)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RecordValue.ts<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - описывает перечеслимый тип JsType, описывающий возможные типы значений полей<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - описывает абстрактный класс RecordValue от которого наследуются все остальные типы значений полей. У любого значения поля (даже примитвного типа string) есть следующий методы:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value - получить логическое значение<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; displayValue - получить значение для показа пользователю<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; toServer - получить значение для отправки серверу в теле POST или PUT запроса<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; toLookup - получить значение для отправки серверу в внутри URI параметров<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set - получить новое значение, для установки на место старого<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ValueFactory.ts&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; fromServer - реализует конвертацию серверных значений в потомков RecordValue на основании JsType типа данных и того являются ли значения поля массивом (isArray)&nbsp;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Реализованные типы значений полей RecordValue<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NumberValue.ts, StringValue.ts, BooleanValue.ts - для примитивных значений number, string и boolean<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EmptyValue.ts - для null и undefined<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DateTimeValues.ts - реализует DateTimeValue, DateValue, TimeValue для дат в соответствующем формате<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PairValue.ts - реализует значение для combobox<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PairArrayValue.ts - реализует значение для массивов combobox<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\definitions</em> - описание типов возможных полей-компонентов в системе ( number, text, textarea, attachment, richtext )<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ComponentDefinition.ts&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - описывает перечеслимый тип FieldStyle, описывающий серверные типы полей<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - описывает перечеслимый тип MobileWidget, описывающий реализованные в системе компонеты<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; - описывает абстрактный класс ComponentDefinition от которого наследуются все остальные компоненты, видно что у компоненты есть имя его поля, подпись поля, название серверного стиля, и название JS типа<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ComponentDefinitionFactory.ts- реализует конвертацию серверного описания поля в потомков ComponentDefinition, для компонента ComboBoxEntityDefinition использует lookupFunction для получение списка данных<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Реализованные типы полей ComponentDefinition:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; StringDefinition - поле ввода строки<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TextDefinition - поле ввода текста в несколько строк<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BooleanDefinition - поле типа "галочка"<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NumericDefinition - поле ввода чисел<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DateDefinition - поле ввода даты<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DateTimeDefinition - поле ввода даты с временем<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TimeDefinition - поле ввода времени<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ComboBoxListDefinition - поле combobox на основании списка<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ComboBoxEntityDefinition - поле combobox на основании запроса к базе<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\entity</em> - реализует работу с данными в форме одной записи и форме списка, их загрузку, создание и изменение<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entity.service.ts - работа с сервером<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loadEntity - загрузка одной записи<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; initEntity - инициализация записи при создании<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loadList - загрузка списка записей<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loadLookup - загрузка списка для ComboBoxEntityDefinition<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processButton - обработка нажатия на кнопку в форме одной записи<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ListRow.ts - описывает тип данных для отображения данных в форме списка<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entity.ts - описывает тип данных для отображения строки на форме одной записи, реализует изменение данных, содержит заготовки для реализации истории изменений для аналога UI-Engine<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RecordValues - класс содержит текущие значения формы одной записи, реализует доступ к данным полей (а такде реализует перобразование к разным форматам), а также к таких характеристикам полей как isEditable, isRequired, isVisible. Представлет собой отдаленной аналог ProxyObject из UiRule web-версии&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Record - класс содержит данные формы одной записи в виде класса RecordValues, реализует построение формы (ModileRecordForm) на основе данных от сервера, реализует нажатия на кнопку, а также содержит описание компонентов (_mobileForm) и их источников данных (_sources), по хорошему _sources логично перенести в компонеты, кторым они соответствуют<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\sources</em> - реализует классы для доступа к серверу компоентов через механизм подписки на элемент класса Rx.Subject (подробнее http://reactivex.io/documentation/subject.html)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CommentsSource.ts - единственный реализованный источник данных для комментариев к записи<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ServerCommentData - формат комментариев от сервера<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CommentDataHeader - данные заголовка группы комментариев<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CommentData - данные отдельного комментария<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CommentsSource - сам класс источника<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _comments - объект типа Subject, на который можно подписаться и данные будут сами обновляться в компоненте сами, после того как в источнике будет сделан _comments.next<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; create - создает новый коммментарий и вызывает обновление объекта подписки<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; listToPlainTree - конвертация данных к клиентскому формату<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ListSource.ts - аналог CommentsSource для не реализованных виртуальных списков<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SourceFactory.ts - пока возвращает только CommentsSource<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\types</em> - другие типы данных<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buttons.ts - содержит описание стандартных и кастомных кнопок, какие из них показывать на мобильниках, с какими иконками и где.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; forms.ts - описание класса формы и таба, помимо тривиального в нем показывается, что не нужно показывать таб с именем hidden, а общее число табов ограничивается Config.maxTabs<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\user</em> - работа с данными пользователя<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user.service.ts - содержит методы логина и разлогина, записывает данные пользователя в глобальный объект Config<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user.ts - поля пользователя<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em> app\shared\alerts</em> - реализует статический метод показа сообщений в диалоговом окне<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\menu</em> - реализует сервис доступа к списку элементов меню. Делает преобразование пришедших от сервера данных к элементам меню для показа слева и прикрепления к кнопке создания.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em> app\shared\common.ts</em> - общие функции такие как toSystemCase, getProperty и setProperty без учета регистра<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\shared\config.ts</em> - объект с настройками приложения, содержит адрес к которому идет логин, форматы даты и времени, разделители и прочее. Также здесь сохраняется токен текущего пользователя.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; <strong>ip-mobile\runidea\app\directives</strong> - кастомные помпоненты, которые вставляются в различные страницы<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Общие моменты<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; У компонентов ввода для передачи значения внутрь директивы используется @Input() value, а из директивы @Output() valueChange = new EventEmitter(), которые позволяют реализовать связывание значения с директивой как [value]="getValue(fieldName)" (valueChange)="setValue(fieldName, $event.value)"<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Пример https://toddmotto.com/component-events-event-emitter-output-angular-2#eventemitter<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\directives\combobox</em> - комбобох для ввода значений, работает в качестве выпадалки и автокомплита, использует библиотеку nativescript-drop-down, и использует примеры из неё (https://github.com/PeterStaev/NativeScript-Drop-Down), не использует пагинацию или загрузку по частично введенному слову<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; combobox.ts - Список значений берется из определения поля. Пока список значений не инициализирован (listInitialized) работа с компонентом не ведется. Для хранения значений внутри компонента используется класс ValueList<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\directives\comments</em> - список комментариев с возможностью добавления<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; comments.ts -&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Реализует методы sendComment, а также обновление списка комментариев.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Для работы с данными использует специальный класс CommentsSource, который реализует метод создания комментария и метод чтения, причем метод чтения возвращает подписку, которая сама обновляет данные при их изменении внутри источника (внутри источника они правда меняются только вызовом create), а от самой подписки нужно не забыть отписаться.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Сохраняет ссылку на нативный элемент для прокрутки вниз при приходе новых данных.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<em> app\directives\tablelist </em>- Не реализовано до конца. Потенциально должно реализовывать список записей для отображения на форме одной записей в качестве виртуального поля. Реализация должна быть схожа с comments<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\directives\create-dialog</em> - реализует модальное меню на создание новой записи, которое появляется при нажатие на плюсик в форме списка.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; create-dialog.ts - Реализует основной компонет, который использует сервис меню для получения списка возможных для создания записей и получает на вход closeCallback, который вызывается с нажатым элементом меню.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\directives\timedatepicker</em> - редактор для дат, времени или и того и другого использует библиотеку nativescript-timedatepicker и её пример использования https://github.com/AntonioCuevaUrraco/nativescript-timedatepicker<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; timedatepicker.ts - основной файл компонента реализует инициализацию и связывание данных<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; timedatepicker-native.ts - файл реализующий открытие компонента, для Android реализует последовательное открытие редактора даты и времени, для iOS - параллельное.<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; <strong>ip-mobile\runidea\app\pages</strong> - экраны приложения переход между которыми выполняется Angular-роутером<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\pages\login</em> - экран логина<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; login.component.ts<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; login - блокирует кнопки при помощи isLoading, устанавливает текущее значение ввода в appSettings для последующих логинов, логинится при помощи _userService, инициализирует меню ответом от сервра и переходит к указнному в ответе сервера списку DefaultList<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\pages\list</em> - экран списка записей, представляет View списком записи, выводя у каждой по четыре значения (id, name, description, date). Соответствие между значения описывается в app\shared\entity\entity.service.ts loadList. Для показа кнопки добавляения в правом нижнем углу используется библиотека nativescript-floatingactionbutton (https://github.com/bradmartin/nativescript-floatingactionbutton)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list.component.ts<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; constructor - инициализация и подписка на изменение роута (подробнее: https://docs.nativescript.org/core-concepts/angular-navigation#passing-parameter)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; getMenuList - меню для показа слева, вызов пробрасывается к сервису меню<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; openItem - обработка тапа по элементу списка для открытия формы одной записи<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; logout - обработка разлогина, чистит токен авторизации и переходит к логину, стирая историю переходов, чтобы исключить возврат по аппаратной кнопке назад на Андроиде<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; openFab - открытие формы одной записи на создание, сначала тап вызывает открытие модального окна со списком возможных вариантов для создания, после разрешения полученного промиса делается переход на форму одной записи с rowId = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <em>app\pages\entity</em> - поле одной записи для редактирования и создания отдельных записей<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entity.component.ts&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Основной функционал работы с полями и кнопками реализуется через поле entity типа Record из app\shared\entity\entity.ts<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; constructor - инициализация и подписка на изменение роута (аналогично app\pages\list\list.component.ts)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; refresh - обновление, создается подписка на обновление, которое в зависимости от того пришел положительный rowId или нет либо загружает имеющуюся запись, либо инициализирует новую. Также выставлает активным первый таб и инициализирует массив SegmentedBarItem для нормальный работы подписей табов.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; setTab - выбор таба активным<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; form - ссылка на мобильные формы<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; buttons - ссылка на кнопки, распиханные по разным полям в зависимости от их назначения и предполагаемого положения на шаблоне<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; process - обработка нажатия на кнопку через this.entity.processButton<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; getField, getFieldWidget, getSource, setValue, getValue, getDisplayValue, get - проброс к соответствующим методам this.entity<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entity.html - Сверху в ActionBar ресуется подпись и кнопка сохранения, Под ним DockLayout для расположение трех основных элементов в заголовке (скролящийся горизонтально список табов), в футере (скролящийся горизонтально список кнопок) и по середине (скролящийся вертикально список полей).