<html><head></head><body><p><strong>Запуск функциональных тестов.</strong></p><p><strong></strong><em>1) Установка </em></p><p><em></em>Ставим NodeJS и NPM, на windows - https://nodejs.org/en/</p><p><span class="Apple-tab-span" style="white-space:pre;"></span>Ставим jdk и прописываем в переменную среды Path ссылку на папку bin в директорию, где установлена jdk. </p><p>Ставим через командную строку глобально protractor - https://angular.github.io/protractor/#/</p><blockquote><span class="Apple-tab-span" style="white-space:pre;"></span>npm install -g protractor<br><span class="Apple-tab-span" style="white-space:pre;"></span>webdriver-manager update<br><span class="Apple-tab-span" style="white-space:pre;"></span>webdriver-manager start</blockquote><p>Скачиваем из SVN (ссылка на репозиторий https://subversion.assembla.com/svn/svn-ip) папку  IdeaPlatform_SAAS\trunk\test\</p><p>В коммандной строке переходим в папку IdeaPlatform_SAAS\trunk\test\e2e (можно скопировать из SVN только её) и выполняем </p><blockquote><span class="Apple-tab-span" style="white-space:pre;"></span>npm install</blockquote><p>Теперь запуск тестов можно выполнять как <span class="Apple-tab-span" style="white-space:pre;">	</span></p><blockquote><span class="Apple-tab-span" style="white-space:pre;"></span>protractor allTestsConf.js</blockquote><p><span class="Apple-tab-span" style="white-space:pre;"></span><em>2) Описание тестов</em><br><span class="Apple-tab-span" style="white-space:pre;"></span><br><span class="Apple-tab-span" style="white-space:pre;"></span><em><span style="text-decoration:underline;">Настройки хранятся в файле globalConf.js</span></em><br><span class="Apple-tab-span" style="white-space:pre;"></span>Наиболее важные -  </p><p><span class="Apple-tab-span" style="white-space:pre;"></span>var host = '193.124.178.223'; // '193.124.178.223'  'runidea.online'   '127.0.0.1' - адрес системы, к которой мы подключаемся</p><p><span class="Apple-tab-span" style="white-space:pre;"></span><span class="Apple-tab-span" style="white-space:pre;"></span>var hostDB = '193.124.178.224'; //'193.124.178.224' null; - адрес субд (для списка пользователей и чтения почты)</p><p><span class="Apple-tab-span" style="white-space:pre;"></span>var port = 8081 - порт системы к которой мы подключаемся</p><p>Порт СУБД считается равным 5432</p><p>config.directConnect - если установлено true - используется подключение к локальному браузеру, иначе к тому что прописано в config.seleniumAddress</p><p><span class="Apple-tab-span" style="white-space:pre;"></span><br><span class="Apple-tab-span" style="white-space:pre;"></span></p><p><span style="text-decoration:underline;"><em>Список тестов хранится в файле allTestsConf.js</em></span></p><p><strong>ВАЖНО: Пока не реализовано создание WS для новых display все сценарии кроме 2 и 3 остановлены, а  сценарии 2 из запускаются из под пользователей указаyных в login.txt</strong></p><div></div><p>Сценарий 1: Регистрация и приглашение пользователей</p>Файлы:<br>specs/registration/registration-spec.js<br>specs/registration/invitation-spec.js<br><br> * == Регистрация<br> * => не пришла почта<br> * => не было перенаправление на форму полной регистрации<br> * => не смогли войти в новый workspace<br> * => не получили приветсвия (можно продолжать при ошибке)<br> * => ошибка личного кабинета при сохранении  (можно продолжать при ошибке)<br> * <br> * == Приглашение<br> * => Не добавилась строка в список пользователей<br> * => Не пришло письмо приглашенному пользователю<br> * => не было перенаправление на форму полной регистрации<br> * => не смогли войти в workspace<br> * => ошибка личного кабинета при сохранении (можно продолжать при ошибке)<br> * <br> * => => => => => => <br><br>Сценарий 2: Работа руководителя команды<br>Файлы:<br>specs/managerScenario/project-with-tasks-spec.js<br><br>Заходим в систему под пользователем (владельцем WS - один из созданных в Сценарий #1 (один менеджер и один подчиненый))<br>Идем в пункт меню создать -> Проект<br>В открывшемся окне заполняем поля "Краткое описание" и "Описание"<br>Название: [Время] - Проект <br>Описание: [Время] - Описание проекта<br>Руководитель проекта: Любого пользователя<br>Переходим на вкладку "Задачи" и жмем на кнопку "Добавить запись"<br>В открывшемся окне заполняем поля "Краткое описание" и "Описание"<br>Краткое описание: [Время] - Задача  ##<user_email><br>Описание: [Время] - Описание задачи Задача ##<user_email><br>Где <user_email> -текущий пользователь. Нажимаем на кнопку "Создать", далее "Назад"<br>Повторяем пункты 4-5 для использую для <user_email> email подчиненного.<br>Переходим к пункту меню Найти -> Задачи, указываем на форме поиска статус Новый и нажимаем на кнопку "Поиск" <br>Выбираем любую из найденных задач, открываем и жмем на кнопку "Запланировать", в открывшемся окне указываем:<br>Исполнитель: заранее выбранный пользователь.<br>Плановое начало: текущий день и 12 часов <br>Плановое окончание: текущий день и 18 часов <br>Жмем на кнопку "ОК"<br>Жмем на кнопку "Комментировать", вводим комментарий и жмем кнопку "Отправить"  (можно продолжать при ошибке)<br>Повторяем пункты 7-9 пока есть задачи в статусе "Новая".<br>Переходим к пункту меню Отчеты - Календарь команды.<br>Передвигаем сроки и меняем длительность любой задачи.  (можно продолжать при ошибке)<br>Проваливаемся в одну из задач и меняем плановое начало и окончание на форме задач, жмем на кнопку "Сохранить"  (можно продолжать при ошибке)<br>Создаем одну задачу нажав правой кнопкой по календарю, выбираем пункт добавить задачу, заполняем поля и жмем "Создать"  (можно продолжать при ошибке)<br>Переходим на пункт меню "Отчеты-Дашборд руководителя", кликаем по столбцу "Задача не начата в срок" и пишем в ней произвольный комментарий  (можно продолжать при ошибке)<br><br>Выходим из системы<br><br>Сценарий 3: Работа члена команды (можно продолжать при ошибке)<br>Файлы:<br>specs/userScenario/tasks-for-user-spec.js<br><br>Войти в систему под пользователем - членом команды (не владельцем WS)<br>Дожидаемся загрузки меню 'Мои задачи'<br>Выбираем одну из задач в статусе "Запланирована", открываем задачу<br>Нажимаем на кнопку "В работу"<br>Жмем на кнопку "Комментировать", вводим комментарий и жмем кнопку "Отправить" <br>Жмем кнопку "На тестирование", вводим комментарий и жмем "ОК"<br>Открываем пункт меню Отчеты->Дашборд команды<br>Кликаем по отчету "Беклог задач", в открывшемся списки выбираем любую задачу и пишем к ней комментарий<br>Выходим из системы<br><br>Сценарий 4: Работа с entity<br>Файлы:<br>specs/newEntity/list-view-spec.js<br>specs/newEntity/new-entity-spec.js<br>specs/newEntity/save-new-entity-data-spec.js<br>specs/newEntity/form-editor-list-spec.js<br>specs/newEntity/form-editor-details-spec.js<br>specs/removeWorkspace/removeWorkspace-spec.js'<br><br>1) Заходим под руководителем WS в entity/entitytype и проверяем наличие стандартных записей data и reference<br>2) Пробуем создать новую entity<br>3) Добавляем всевозможные поля с разнным FieldFormat<br>4) Проверяем, что результирующее число полей правильное<br>5) Проверяем, что создались формы для списка и одной записи<br>6) Проверяем, что можем скрыть одну колонку и показать другую в редакторе списка<br>7) Проверяем, что создается новый таб в редакторе формы одной записи<br>8) Проверяем, что в него переносится запись в этот таб<br><br>Сценарий 5. Очистка созданного тестового WS.<p></p><p><strong>Запуск нагрузочных тестов</strong><br><br><em>1) Установка </em><br><span class="Apple-tab-span" style="white-space:pre;"></span>Для запуска нагрузочных тестов используется пакет JMeter. Он запускает написанные в нем тестовые сценарии в несколько потоков (обычно до сотни, что соответсвует нескольким тысячам пользователей) при этом внутри каждого потока написанные тесты запускаются последовательно и со своими параметрами<br><span class="Apple-tab-span" style="white-space:pre;"></span>Устанавливаем актуальную версию JVM<br><span class="Apple-tab-span" style="white-space:pre;"></span>Скачиваем последнюю версию JMeter (http://jmeter.apache.org/) и распаковываем архив с ней (далее считаем что в папку java/jmeter, убеждаемся что там есть lib и lib/ext) <br><span class="Apple-tab-span" style="white-space:pre;"></span>Скачиваем дополнение JMeterPlugins-ExtrasLibs (http://jmeter-plugins.org/downloads/all/) и распаковываем его в папку java/jmeter<br><span class="Apple-tab-span" style="white-space:pre;"></span>Открываем java/jmeter/bin/ApacheJMeter.jar И пробуем открыть файл теста<span class="Apple-tab-span" style="white-space:pre;">	</span><br><br><em>2) Работа с тестами</em><br><span class="Apple-tab-span" style="white-space:pre;"></span>На данный момент нагрузочные тесты для SAAS реализованы в рамках задачи 503, соответственно и файл тестов называется 503.jmx<br><br><span class="Apple-tab-span" style="white-space:pre;"></span><strong><em>503</em></strong><br><br><span class="Apple-tab-span" style="white-space:pre;"></span>Входные данные - файлы logins_saas_managers.csv и logins_saas.csv должны лежать в тойже папке, что и файл 503.jmx.<br><span class="Apple-tab-span" style="white-space:pre;"></span>Первый из них содержит всех пользователей, учавствующих в тестировании, в формате <email>,<password>,<isAdmin ? 1 : 0>, второй тотже список, но только из админов.<br><br><span class="Apple-tab-span" style="white-space:pre;"></span>Открываем описание задачи и видим в ней Сценарий 2 и Сценарий 3. Поскольку число процессов для сценария 3 должно быть больше, чем для Сценария 2, то Сценарий 2 и Сценарий 3 нельзя запускать последовательно. При этом Сценарий 3 использует данные Сценария 2, следовательно перед запуском основного теста необходим предварительный запуск Сценария 2.<br><br><span class="Apple-tab-span" style="white-space:pre;"></span>Для реализации такого поведения в задаче созданы две ветки (элементы типа Thread Group) "Подготовка к задаче 503" и непосредственно "Задача 503", для правильной работы должнабыть выбрана только одна ветка. Включение/отключение ветки - Ctrl+T. Все ветки после этих двух служебные и на время тестирования отключаются. Перед этими двумя ветками блок с адресом и портом тестируемого сервера.<br><span class="Apple-tab-span" style="white-space:pre;"></span>Каждой из веток указан входной файл (logins_saas_managers.csv в подготовке и logins_saas.csv в основном тесте) содержащий список пар логин-пароль<br><span class="Apple-tab-span" style="white-space:pre;"></span>У каждой из них есть свои параметры. Число потоков, в подготовке оно обычно больше или равно числу администраторов в файле logins_saas_managers.csv, в основном тесте - в зависимости от постановки задачи (но не нет смысла делать больше числа пользователей). Период прогрева и количество циклов - насколько нужно растянуть по времени запуск программы, можно оставить как есть.<br><span class="Apple-tab-span" style="white-space:pre;"></span>Ветка подготовки может быть запущена только один раз для файла каждого набора workspace'ов. При повторном запуске тестов это не обязательно. <br><span class="Apple-tab-span" style="white-space:pre;"></span>Для мониторинга вставляем в соответствующую ветку блоки "View Results in Table", он содержат спиок всех запросов к серверу. Сброс значения перед новым тестом - копируем в текущую ветку, старую удаляем.<br><br><span class="Apple-tab-span" style="white-space:pre;"></span>Таким образом запуск теста будет происходить следующим образом.<br><span class="Apple-tab-span" style="white-space:pre;"></span>1) Проверяем файлы  logins_saas_managers.csv и logins_saas.csv<br><span class="Apple-tab-span" style="white-space:pre;"></span>2) Устанавливаем в блоке "Параметры запросов по умолчанию" адрес и порт запросов<br><span class="Apple-tab-span" style="white-space:pre;"></span>3) Если раньше не работали с этим списком (иначе сразу к пункту 6) активируем "Подготовка к задаче 503" проверяем, что у нее внутри есть включенный блок мониторинга, а число потоков не меньше числа рабочих пространств в тесте. Деактивируем "Задача 503".<br><span class="Apple-tab-span" style="white-space:pre;"></span>4) Запускаем тест и ждем окончания, можем наблюдать за ходом теста по блоку "View Results Tree" или "View Results in Table".<br><span class="Apple-tab-span" style="white-space:pre;"></span>5) Проверяем что все нормально<br><span class="Apple-tab-span" style="white-space:pre;"></span>6) Деактивируем "Подготовка к задаче 503", активируем "Задача 503", проверяем число потоков и количество циклов, проверяем, что есть работающий пустой блок "View Results in Table"<br><span class="Apple-tab-span" style="white-space:pre;"></span>7) Запускаем тест и ждем окончания, можем наблюдать за ходом теста по блоку "View Results Tree".<br><span class="Apple-tab-span" style="white-space:pre;"></span>8) Копируем данные из "View Results Tree" excel файл Result.xlsx на новую вкладку, копируем колонки с расчетами аналогично уже имеющимся в файле вкладкам<br><span class="Apple-tab-span" style="white-space:pre;"></span>9) Анализируем данные в Excel<br><br><br><br><span class="Apple-tab-span" style="white-space:pre;"></span></p>       </body></html>